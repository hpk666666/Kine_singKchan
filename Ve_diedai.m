function data=Ve_diedai(u,n,Ve,VL,E,Ka,Lb,L)
data=zeros(5,n+1);%生成一个5行n+1列的0矩阵
data(:,1)=[24*Lb(1)^4/(L^4*(Ve-VL)^4*(u+1)*(u+2)*(u+3)*(u+4));
          -24*Lb(1)^3/(L^3*(Ve-VL)^3*(u+1)*(u+2)*(u+3));
           12*Lb(1)^2/(L^2*(Ve-VL)^2*(u+1)*(u+2));
          -4*Lb(1)/(L*(Ve-VL)*(u+1));
           1];
%H_0
ta_1=[L*(Ve-VL)*(u+5),Lb(1),          0,              0,              0;
      0,              L*(Ve-VL)*(u+4),2*Lb(1),        0,              0; 
      0,              0,              L*(Ve-VL)*(u+3),3*Lb(1),        0; 
      0,              0,              0,              L*(Ve-VL)*(u+2),4*Lb(1); 
      0,              0,              0,              0,              E*(u+2)-4*Lb(1)];
tc_1=[4*Ka(1)-L*(u+5),-Lb(2),               0,                      0,                       0;
      0,              3*Ka(1)+Lb(1)-L*(u+4),-2*Lb(2),               0,                       0; 
      0,              0,                    2*(Ka(1)+Lb(1))-L*(u+3),-3*Lb(2),                0; 
      0,              0,                    0,                      (Ka(1)+3*Lb(1))-L*(u+2),-4*Lb(2); 
      0,              0,                    0,                      -Ka(1),                  4*Lb(2)];
data(:,2)=(ta_1)\(tc_1*data(:,1));%矩阵左除，x = A\B 是方程 Ax = B 的解。矩阵 A 和 B 必须拥有相同的行数。
ta_2=[L*(Ve-VL)*(u+6),Lb(1),          0,              0,              0;
      0,              L*(Ve-VL)*(u+5),2*Lb(1),        0,              0; 
      0,              0,              L*(Ve-VL)*(u+4),3*Lb(1),        0; 
      0,              0,              0,              L*(Ve-VL)*(u+3),4*Lb(1); 
      0,              0,              0,              0,              E*(u+3)-4*Lb(1)];
tb_2=[4*Ka(2),-Lb(3),         0,               0,              0;
     -4*Ka(1), 3*Ka(2)+Lb(2),-2*Lb(3),         0,              0; 
      0,      -3*Ka(1),       2*(Ka(2)+Lb(2)),-3*Lb(3),        0; 
      0,       0,            -2*Ka(1),        (Ka(2)+3*Lb(2)),-4*Lb(3); 
      0,       0,             0,              -Ka(2),          4*Lb(3)];
tc_2=[4*Ka(1)-L*(u+6),-Lb(2),                 0,                       0,                      0;
      0,               3*Ka(1)+Lb(1)-L*(u+5),-2*Lb(2),                 0,                      0; 
      0,               0,                     2*(Ka(1)+Lb(1))-L*(u+4),-3*Lb(2),                0; 
      0,               0,                     0,                      (Ka(1)+3*Lb(1))-L*(u+3),-4*Lb(2); 
      0,               0,                     0,                      -Ka(1),                  4*Lb(2)];
data(:,3)=(ta_2)\(tb_2*data(:,1)+tc_2*data(:,2));
for i=3:n
    ta_i=[L*(Ve-VL)*(u+4+i),Lb(1),            0,                0,                0;
          0,                L*(Ve-VL)*(u+3+i),2*Lb(1),          0,                0; 
          0,                0,                L*(Ve-VL)*(u+2+i),3*Lb(1),          0; 
          0,                0,                0,                L*(Ve-VL)*(u+1+i),4*Lb(1); 
          0,                0,                0,                0,                E*(u+1+i)-4*Lb(1)]; 
    tc_i=[4*Ka(1)-L*(u+i+4),-Lb(2),                   0,                         0,                         0;
          0,                 3*Ka(1)+Lb(1)-L*(u+i+3),-2*Lb(2),                   0,                         0; 
          0,                 0,                       2*(Ka(1)+Lb(1))-L*(u+i+2),-3*Lb(2),                   0; 
          0,                 0,                       0,                         (Ka(1)+3*Lb(1))-L*(u+i+1),-4*Lb(2); 
          0,                 0,                       0,                         -Ka(1),                    4*Lb(2)];
    td=zeros(5,1);
    for j=2:i
        tb_j=[4*Ka(j), -Lb(j+1),       0,               0,              0;
       -4*Ka(j-1),3*Ka(j)+Lb(j),-2*Lb(j+1),       0,              0; 
        0,       -3*Ka(j-1),     2*(Ka(j)+Lb(j)),-3*Lb(j+1),      0; 
        0,        0,            -2*Ka(j-1),      (Ka(j)+3*Lb(j)),-4*Lb(j+1); 
        0,        0,             0,              -Ka(j),          4*Lb(j+1)];
        td=td+tb_j*data(:,i-j+1);
    end
    data(:,i+1)=(ta_i)\(td+tc_i*data(:,i));
end
end