function [Ex_2]=EX_2(VL,V_mid,Ve,data,n)
Ex_2=zeros(1,5);
for i=1:n+1 
      Ex_2(1,1)=data(1,i)*(1/((i-1)+3)*(VL-V_mid).^((i-1)+3)...
      +V_mid^2*1/((i-1)+1)*(VL-V_mid).^((i-1)+1)...
      +2*V_mid*1/((i-1)+2)*(VL-V_mid).^((i-1)+2))...%%%
      -(data(1,i)*1/((i-1)+3)*(Ve-V_mid).^((i-1)+3)...
      +data(1,i)*V_mid^2*1/((i-1)+1)*(Ve-V_mid).^((i-1)+1)...
      +2*V_mid*(data(1,i)*1/((i-1)+2)*(Ve-V_mid).^((i-1)+2)))...
      +Ex_2(1,1);
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%
        Ex_2(1,2)=data(2,i)*1/((i-1)+3)*(VL-V_mid).^((i-1)+3)...
      +data(2,i)*V_mid^2*1/((i-1)+1)*(VL-V_mid).^((i-1)+1)...
      +2*V_mid*(data(2,i)*1/((i-1)+2)*(VL-V_mid).^((i-1)+2))...%%%
      -(data(2,i)*1/((i-1)+3)*(Ve-V_mid).^((i-1)+3)...
      +data(2,i)*V_mid^2*1/((i-1)+1)*(Ve-V_mid).^((i-1)+1)...
      +2*V_mid*(data(2,i)*1/((i-1)+2)*(Ve-V_mid).^((i-1)+2)))...
      +Ex_2(1,2);
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
          Ex_2(1,3)=data(3,i)*1/((i-1)+3)*(VL-V_mid).^((i-1)+3)...
      +data(3,i)*V_mid^2*1/((i-1)+1)*(VL-V_mid).^((i-1)+1)...
      +2*V_mid*(data(3,i)*1/((i-1)+2)*(VL-V_mid).^((i-1)+2))...%%%
      -(data(3,i)*1/((i-1)+3)*(Ve-V_mid).^((i-1)+3)...
      +data(3,i)*V_mid^2*1/((i-1)+1)*(Ve-V_mid).^((i-1)+1)...
      +2*V_mid*(data(3,i)*1/((i-1)+2)*(Ve-V_mid).^((i-1)+2)))...
      +Ex_2(1,3);
  %%%%%%%%%%%%%%%%
          Ex_2(1,4)=data(4,i)*1/((i-1)+3)*(VL-V_mid).^((i-1)+3)...
      +data(4,i)*V_mid^2*1/((i-1)+1)*(VL-V_mid).^((i-1)+1)...
      +2*V_mid*(data(4,i)*1/((i-1)+2)*(VL-V_mid).^((i-1)+2))...%%%
      -(data(4,i)*1/((i-1)+3)*(Ve-V_mid).^((i-1)+3)...
      +data(4,i)*V_mid^2*1/((i-1)+1)*(Ve-V_mid).^((i-1)+1)...
      +2*V_mid*(data(4,i)*1/((i-1)+2)*(Ve-V_mid).^((i-1)+2)))...
      +Ex_2(1,4);
  %%%%%%%%%%%%%%%%%%%%%
          Ex_2(1,5)=data(5,i)*1/((i-1)+3)*(VL-V_mid).^((i-1)+3)...
      +data(5,i)*V_mid^2*1/((i-1)+1)*(VL-V_mid).^((i-1)+1)...
      +2*V_mid*(data(5,i)*1/((i-1)+2)*(VL-V_mid).^((i-1)+2))...%%%
      -(data(5,i)*1/((i-1)+3)*(Ve-V_mid).^((i-1)+3)...
      +data(5,i)*V_mid^2*1/((i-1)+1)*(Ve-V_mid).^((i-1)+1)...
      +2*V_mid*(data(5,i)*1/((i-1)+2)*(Ve-V_mid).^((i-1)+2)))...
      +Ex_2(1,5);
end
end